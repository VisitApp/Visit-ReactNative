{"version":3,"names":["requestActivityRecognitionPermission","webviewRef","console","log","granted","PermissionsAndroid","request","PERMISSIONS","ACTIVITY_RECOGNITION","title","message","buttonNeutral","buttonNegative","buttonPositive","RESULTS","GRANTED","askForGoogleFitPermission","err","warn","NativeModules","VisitFitnessModule","initiateSDK","isPermissionGranted","askForFitnessPermission","getDailyFitnessData","e","error","requestDailyFitnessData","data","current","injectJavaScript","requestActivityData","type","frequency","timeStamp","requestActivityDataFromGoogleFit","requestLocationPermission","ACCESS_FINE_LOCATION","updateApiBaseUrl","apiBaseUrl","authtoken","googleFitLastSync","gfHourlyLastSync","handleMessage","event","nativeEvent","parsedObject","JSON","parse","method","timestamp","hraUrl","url","openHraLink","exception","fetchDailyFitnessData","startTimeStamp","Promise","resolve","reject","then","result","catch","fetchHourlyFitnessData"],"sources":["VisitPluginAndroid.js"],"sourcesContent":["import {LogBox, NativeModules, PermissionsAndroid} from 'react-native';\n\n\n\nexport const requestActivityRecognitionPermission = async (\n  webviewRef\n) => {\n  console.log('inside requestActivityRecognitionPermission()');\n  try {\n    const granted = await PermissionsAndroid.request(\n      PermissionsAndroid.PERMISSIONS.ACTIVITY_RECOGNITION,\n      {\n        title: 'Need Activity Recognition Permission',\n        message: 'This needs access to your Fitness Permission',\n        buttonNeutral: 'Ask Me Later',\n        buttonNegative: 'Cancel',\n        buttonPositive: 'OK',\n      },\n    );\n    if (granted === PermissionsAndroid.RESULTS.GRANTED) {\n      console.log('ACTIVITY_RECOGNITION granted');\n\n      askForGoogleFitPermission(webviewRef);\n    } else {\n      console.log('Fitness permission denied');\n    }\n  } catch (err) {\n    console.warn(err);\n  }\n};\n\nconst askForGoogleFitPermission = async (webviewRef) => {\n  try {\n    NativeModules.VisitFitnessModule.initiateSDK();\n\n    const isPermissionGranted =\n      await NativeModules.VisitFitnessModule.askForFitnessPermission();\n    if (isPermissionGranted == 'GRANTED') {\n      getDailyFitnessData(webviewRef);\n    }\n    console.log(`Google Fit Permissionl: ${isPermissionGranted}`);\n  } catch (e) {\n    console.error(e);\n  }\n};\n\nconst getDailyFitnessData = webviewRef => {\n  console.log('getDailyFitnessData() called');\n\n  NativeModules.VisitFitnessModule.requestDailyFitnessData(data => {\n    console.log(`getDailyFitnessData() data: ` + data);\n    webviewRef.current.injectJavaScript(data);\n  });\n};\n\nexport const requestActivityData = (type, frequency, timeStamp, webviewRef) => {\n  console.log('requestActivityData() called');\n\n  NativeModules.VisitFitnessModule.requestActivityDataFromGoogleFit(\n    type,\n    frequency,\n    timeStamp,\n    data => {\n      console.log(`requestActivityData() data: ` + data);\n      webviewRef.current.injectJavaScript('window.' + data);\n    },\n  );\n};\n\nexport const requestLocationPermission = async () => {\n  try {\n    const granted = await PermissionsAndroid.request(\n      PermissionsAndroid.PERMISSIONS.ACCESS_FINE_LOCATION,\n      {\n        title: 'Need Location Permission',\n        message: 'Need access to location permission',\n        buttonNeutral: 'Ask Me Later',\n        buttonNegative: 'Cancel',\n        buttonPositive: 'OK',\n      },\n    );\n    if (granted === PermissionsAndroid.RESULTS.GRANTED) {\n      console.log('Location permission granted');\n    } else {\n      console.log('Fitness permission denied');\n    }\n  } catch (e) {\n    console.error(e);\n  }\n};\n\nexport const updateApiBaseUrl = (\n  apiBaseUrl,\n  authtoken,\n  googleFitLastSync,\n  gfHourlyLastSync\n) => {\n  console.log('updateApiBaseUrl() called.');\n  NativeModules.VisitFitnessModule.initiateSDK();\n\n  NativeModules.VisitFitnessModule.updateApiBaseUrl(\n    apiBaseUrl,\n    authtoken,\n    googleFitLastSync,\n    gfHourlyLastSync,\n  );\n};\n\nexport const handleMessage = (event, webviewRef) => {\n  console.log(\n    'event:' +\n      event +\n      ' webviewRef: ' +\n      webviewRef\n  );\n\n  if (event.nativeEvent.data != null) {\n    try {\n      const parsedObject = JSON.parse(event.nativeEvent.data);\n\n      if (parsedObject.method != null) {\n        switch (parsedObject.method) {\n          case 'CONNECT_TO_GOOGLE_FIT':\n            requestActivityRecognitionPermission(webviewRef);\n            break;\n          case 'UPDATE_PLATFORM':\n            webviewRef.current?.injectJavaScript(\n              'window.setSdkPlatform(\"ANDROID\")',\n            );\n            break;\n          case 'UPDATE_API_BASE_URL':\n            {\n              let apiBaseUrl = parsedObject.apiBaseUrl;\n              let authtoken = parsedObject.authtoken;\n\n              let googleFitLastSync = parsedObject.googleFitLastSync;\n              let gfHourlyLastSync = parsedObject.gfHourlyLastSync;\n\n              console.log(\n                'apiBaseUrl: ' +\n                  apiBaseUrl +\n                  ' authtoken: ' +\n                  authtoken +\n                  ' googleFitLastSync: ' +\n                  googleFitLastSync +\n                  ' gfHourlyLastSync: ' +\n                  gfHourlyLastSync,\n              );\n\n              updateApiBaseUrl(\n                apiBaseUrl,\n                authtoken,\n                googleFitLastSync,\n                gfHourlyLastSync\n              );\n            }\n            break;\n          case 'GET_DATA_TO_GENERATE_GRAPH':\n            {\n              let type = parsedObject.type;\n              let frequency = parsedObject.frequency;\n              let timeStamp = parsedObject.timestamp;\n\n              console.log(\n                'type: ' +\n                  type +\n                  ' frequency:' +\n                  frequency +\n                  ' timeStamp: ' +\n                  timeStamp,\n              );\n\n              requestActivityData(type, frequency, timeStamp, webviewRef);\n            }\n            break;\n          case 'GET_LOCATION_PERMISSIONS':\n            {\n              requestLocationPermission();\n            }\n            break;\n          case 'CLOSE_VIEW':\n            {\n            }\n            break;\n          case 'OPEN_PDF':\n            let hraUrl = parsedObject.url;\n\n            NativeModules.VisitFitnessModule.openHraLink(hraUrl);\n            console.log('HRA URL:' + hraUrl);\n\n            break;\n          default:\n            break;\n        }\n      }\n    } catch (exception) {\n      console.log('Exception occured:' + exception.message);\n    }\n  }\n};\n\n\nexport const fetchDailyFitnessData = (startTimeStamp)=>{\n\n  return new Promise((resolve,reject)=>{\n    console.log(\"fetchDailyFitnessData called: \"+startTimeStamp);\n\n    NativeModules.VisitFitnessModule.initiateSDK();\n\n    NativeModules.VisitFitnessModule.fetchDailyFitnessData(startTimeStamp).then((result)=> {\n      resolve(result);\n    })\n    .catch((err)=> reject(err));\n  });\n\n \n}\n\nexport const fetchHourlyFitnessData = startTimeStamp=>{\n\n  return new Promise((resolve,reject)=>{\n\n    console.log(\"fetchHourlyFitnessData called: \"+startTimeStamp);\n\n    NativeModules.VisitFitnessModule.initiateSDK();\n\n    NativeModules.VisitFitnessModule.fetchHourlyFitnessData(startTimeStamp).then((result)=> {\n    resolve(result);\n    }).catch((err)=>reject(err));\n    \n});\n}\n"],"mappings":"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"}