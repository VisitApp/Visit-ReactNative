{"version":3,"names":["LogBox","NativeModules","PermissionsAndroid","requestActivityRecognitionPermission","webviewRef","console","log","granted","request","PERMISSIONS","ACTIVITY_RECOGNITION","title","message","buttonNeutral","buttonNegative","buttonPositive","RESULTS","GRANTED","askForGoogleFitPermission","err","warn","VisitFitnessModule","initiateSDK","isPermissionGranted","askForFitnessPermission","getDailyFitnessData","e","error","requestDailyFitnessData","data","current","injectJavaScript","requestActivityData","type","frequency","timeStamp","requestActivityDataFromGoogleFit","requestLocationPermission","ACCESS_FINE_LOCATION","updateApiBaseUrl","apiBaseUrl","authtoken","googleFitLastSync","gfHourlyLastSync","handleMessage","event","nativeEvent","parsedObject","JSON","parse","method","timestamp","hraUrl","url","openHraLink","exception"],"sources":["VisitPluginAndroid.js"],"sourcesContent":["import {LogBox, NativeModules, PermissionsAndroid} from 'react-native';\n\n\n\nexport const requestActivityRecognitionPermission = async (\n  webviewRef\n) => {\n  console.log('inside requestActivityRecognitionPermission()');\n  try {\n    const granted = await PermissionsAndroid.request(\n      PermissionsAndroid.PERMISSIONS.ACTIVITY_RECOGNITION,\n      {\n        title: 'Need Activity Recognition Permission',\n        message: 'This needs access to your Fitness Permission',\n        buttonNeutral: 'Ask Me Later',\n        buttonNegative: 'Cancel',\n        buttonPositive: 'OK',\n      },\n    );\n    if (granted === PermissionsAndroid.RESULTS.GRANTED) {\n      console.log('ACTIVITY_RECOGNITION granted');\n\n      askForGoogleFitPermission(webviewRef);\n    } else {\n      console.log('Fitness permission denied');\n    }\n  } catch (err) {\n    console.warn(err);\n  }\n};\n\nconst askForGoogleFitPermission = async (webviewRef) => {\n  try {\n    NativeModules.VisitFitnessModule.initiateSDK();\n\n    const isPermissionGranted =\n      await NativeModules.VisitFitnessModule.askForFitnessPermission();\n    if (isPermissionGranted == 'GRANTED') {\n      getDailyFitnessData(webviewRef);\n    }\n    console.log(`Google Fit Permissionl: ${isPermissionGranted}`);\n  } catch (e) {\n    console.error(e);\n  }\n};\n\nconst getDailyFitnessData = webviewRef => {\n  console.log('getDailyFitnessData() called');\n\n  NativeModules.VisitFitnessModule.requestDailyFitnessData(data => {\n    console.log(`getDailyFitnessData() data: ` + data);\n    webviewRef.current.injectJavaScript(data);\n  });\n};\n\nexport const requestActivityData = (type, frequency, timeStamp, webviewRef) => {\n  console.log('requestActivityData() called');\n\n  NativeModules.VisitFitnessModule.requestActivityDataFromGoogleFit(\n    type,\n    frequency,\n    timeStamp,\n    data => {\n      console.log(`requestActivityData() data: ` + data);\n      webviewRef.current.injectJavaScript('window.' + data);\n    },\n  );\n};\n\nexport const requestLocationPermission = async () => {\n  try {\n    const granted = await PermissionsAndroid.request(\n      PermissionsAndroid.PERMISSIONS.ACCESS_FINE_LOCATION,\n      {\n        title: 'Need Location Permission',\n        message: 'Need access to location permission',\n        buttonNeutral: 'Ask Me Later',\n        buttonNegative: 'Cancel',\n        buttonPositive: 'OK',\n      },\n    );\n    if (granted === PermissionsAndroid.RESULTS.GRANTED) {\n      console.log('Location permission granted');\n    } else {\n      console.log('Fitness permission denied');\n    }\n  } catch (e) {\n    console.error(e);\n  }\n};\n\nexport const updateApiBaseUrl = (\n  apiBaseUrl,\n  authtoken,\n  googleFitLastSync,\n  gfHourlyLastSync\n) => {\n  console.log('updateApiBaseUrl() called.');\n  NativeModules.VisitFitnessModule.initiateSDK();\n\n  NativeModules.VisitFitnessModule.updateApiBaseUrl(\n    apiBaseUrl,\n    authtoken,\n    googleFitLastSync,\n    gfHourlyLastSync,\n  );\n};\n\nexport const handleMessage = (event, webviewRef) => {\n  console.log(\n    'event:' +\n      event +\n      ' webviewRef: ' +\n      webviewRef\n  );\n\n  if (event.nativeEvent.data != null) {\n    try {\n      const parsedObject = JSON.parse(event.nativeEvent.data);\n\n      if (parsedObject.method != null) {\n        switch (parsedObject.method) {\n          case 'CONNECT_TO_GOOGLE_FIT':\n            requestActivityRecognitionPermission(webviewRef);\n            break;\n          case 'UPDATE_PLATFORM':\n            webviewRef.current?.injectJavaScript(\n              'window.setSdkPlatform(\"ANDROID\")',\n            );\n            break;\n          case 'UPDATE_API_BASE_URL':\n            {\n              let apiBaseUrl = parsedObject.apiBaseUrl;\n              let authtoken = parsedObject.authtoken;\n\n              let googleFitLastSync = parsedObject.googleFitLastSync;\n              let gfHourlyLastSync = parsedObject.gfHourlyLastSync;\n\n              console.log(\n                'apiBaseUrl: ' +\n                  apiBaseUrl +\n                  ' authtoken: ' +\n                  authtoken +\n                  ' googleFitLastSync: ' +\n                  googleFitLastSync +\n                  ' gfHourlyLastSync: ' +\n                  gfHourlyLastSync,\n              );\n\n              updateApiBaseUrl(\n                apiBaseUrl,\n                authtoken,\n                googleFitLastSync,\n                gfHourlyLastSync\n              );\n            }\n            break;\n          case 'GET_DATA_TO_GENERATE_GRAPH':\n            {\n              let type = parsedObject.type;\n              let frequency = parsedObject.frequency;\n              let timeStamp = parsedObject.timestamp;\n\n              console.log(\n                'type: ' +\n                  type +\n                  ' frequency:' +\n                  frequency +\n                  ' timeStamp: ' +\n                  timeStamp,\n              );\n\n              requestActivityData(type, frequency, timeStamp, webviewRef);\n            }\n            break;\n          case 'GET_LOCATION_PERMISSIONS':\n            {\n              requestLocationPermission();\n            }\n            break;\n          case 'CLOSE_VIEW':\n            {\n            }\n            break;\n          case 'OPEN_PDF':\n            let hraUrl = parsedObject.url;\n\n            NativeModules.VisitFitnessModule.openHraLink(hraUrl);\n            console.log('HRA URL:' + hraUrl);\n\n            break;\n          default:\n            break;\n        }\n      }\n    } catch (exception) {\n      console.log('Exception occured:' + exception.message);\n    }\n  }\n};\n"],"mappings":"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"}