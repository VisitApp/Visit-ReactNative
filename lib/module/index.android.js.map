{"version":3,"names":["React","useRef","useEffect","useState","useCallback","SafeAreaView","BackHandler","Platform","handleMessage","fetchHourlyFitnessData","fetchDailyFitnessData","WebView","getRunBeforeFirst","platform","runBeforeFirst","OS","console","log","VisitHealthView","baseUrl","token","id","phone","moduleName","source","setSource","webviewRef","runBeforeStart","canGoBack","setCanGoBack","handleBack","current","goBack","addEventListener","removeEventListener","flex","uri","headers","event","nativeEvent","defaultProps"],"sources":["index.android.js"],"sourcesContent":["import React, { useRef, useEffect, useState, useCallback } from 'react';\n\nimport { SafeAreaView, BackHandler, Platform } from 'react-native';\nimport {\n  handleMessage,\n  fetchHourlyFitnessData,\n  fetchDailyFitnessData,\n} from './VisitPluginAndroid';\nimport WebView from 'react-native-webview';\n\nfunction getRunBeforeFirst(platform) {\n  let runBeforeFirst = null;\n\n  if (Platform.OS == 'android') {\n    runBeforeFirst = `\n        window.isNativeApp = true;\n        window.platform = \"ANDROID\";\n        window.setSdkPlatform('ANDROID');\n        true; // note: this is required, or you'll sometimes get silent failures\n    `;\n  } else if (Platform.OS == 'ios') {\n    runBeforeFirst = `\n        window.isNativeApp = true;\n        window.platform = \"IOS\";\n        window.setSdkPlatform('IOS');\n        true; // note: this is required, or you'll sometimes get silent failures\n    `;\n  }\n  console.log('runBeforeFirst: ' + runBeforeFirst);\n\n  return runBeforeFirst;\n}\n\nconst VisitHealthView = ({ baseUrl, token, id, phone, moduleName }) => {\n  const [source, setSource] = useState('');\n  useEffect(() => {\n    setSource(\n      `${baseUrl}?token=${token}&id=${id}&phone=${phone}&moduleName=${moduleName}`\n    );\n  }, [id, token, baseUrl, phone, moduleName]);\n  const webviewRef = useRef(null);\n\n  const runBeforeStart = getRunBeforeFirst(Platform.OS);\n\n  const [canGoBack, setCanGoBack] = useState(false);\n\n  const handleBack = useCallback(() => {\n    if (canGoBack && webviewRef.current) {\n      webviewRef.current.goBack();\n      return true;\n    }\n    return false;\n  }, [canGoBack]);\n\n  useEffect(() => {\n    BackHandler.addEventListener('hardwareBackPress', handleBack);\n    return () => {\n      BackHandler.removeEventListener('hardwareBackPress', handleBack);\n    };\n  }, [handleBack]);\n\n  console.log('source: ', source);\n\n  return (\n    <SafeAreaView style={{ flex: 1 }}>\n      {source ? (\n        <WebView\n          ref={webviewRef}\n          source={{\n            uri: source,\n            headers: {\n              platform: 'ANDROID',\n            },\n          }}\n          onMessage={(event) => handleMessage(event, webviewRef)}\n          injectedJavaScriptBeforeContentLoaded={runBeforeStart}\n          javaScriptEnabled={true}\n          onLoadProgress={(event) => setCanGoBack(event.nativeEvent.canGoBack)}\n        />\n      ) : null}\n    </SafeAreaView>\n  );\n};\n\nexport default VisitHealthView;\nexport { fetchHourlyFitnessData, fetchDailyFitnessData };\n\nVisitHealthView.defaultProps = {\n  id: '',\n  token: '',\n  baseUrl: '',\n  phone: '',\n  moduleName: '',\n};\n"],"mappings":"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"}